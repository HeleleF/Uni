BBLog.handle("add.plugin",{id:"bf4-advanced-scoreboard-plugin-dev-1-0",name:"Advanced Scoreboard",version:"1.0",build:"20151210",init:function(a){a.data.currentPath=location.pathname;location.pathname.match(/^\/bf4\/(|[a-z]{2}\/)(servers|serverbrowserwarsaw)\/show\/pc\/.*/i)&&a.handler(a)},domchange:function(a){location.pathname!=a.data.currentPath&&(a.data.pluginLoaded&&a.unloadPlugin(a),a.data.currentPath=location.pathname,location.pathname.match(/^\/bf4\/(|[a-z]{2}\/)(servers|serverbrowserwarsaw)\/show\/pc\/.*/i)&&
$(document).ready(function(){a.handler(a)}))},ticker:{isActive:!1,id:!1,start:function(a){if(this.isActive||this.id)return a.debug(a,2,"Attempted to start ticker when existing ticker is already active"),!1;this.id=setInterval(function(){a.updateAll(a)},5E3);this.isActive=!0;a.debug(a,0,"Ticker has been started  ("+this.id.toString()+")");return!0},stop:function(a){if(!this.isActive||!this.id)return a.debug(a,2,"Attempted to stop a ticker but no active ticker was found"),!1;clearInterval(this.id);
this.isActive=this.id=!1;a.debug(a,0,"Ticker has been stopped");return!1}},battlelog:{lookup:{},getVehicleImage:function(a,b){var d=window.items.game_data.compact.vehicles;return d[d[a].see[b]].imageConfig.slug},getWeaponImage:function(a,b){var d=window.items.game_data.compact.weapons;return d[d[a].see[b]].imageConfig.slug},getMapTitle:function(a){"undefined"==typeof this.lookup.gameserverwarsaw&&(this.lookup.gameserverwarsaw=gamedatawarsaw.function_warsawgameserver());return mapTitle=this.lookup.gameserverwarsaw.mapLookup[a].label},
getGameMode:function(a){return gamedata.function_localizedGameMode(2048,a)},getServerInfo:function(a,b){$.ajax({url:"http://battlelog.battlefield.com/bf4/servers/show/"+a+"/?json=1",type:"GET",async:!0,cache:!1,timeout:3E4,success:function(a){b(a)}})}},data:{advancedViewPlayer:0,animationActive:!1,asLiveUpdate:!1,asTrackerUpdate:!1,charts:{skillDistribution:!1,tickets:!1},currentChart:!1,ticketsChart:!1,currentPath:"",drawMode:"player",gameServerWarsaw:gamedatawarsaw.function_warsawgameserver(),latestScoreboardData:{},
mode:"scoreboard",onServerPage:!1,pluginLoaded:!1,scoreboard:{advancedViewPlayer:!1,animationActive:!1},server:{},tracker:{tickets:{},kills:{}}},playerStats:{},playerVehicleStats:{},translations:{en:{"settings-title":"Settings"},de:{"settings-title":"Einstellungen"}},handler:function(a){window.asDebug=a;a.ticker.isActive=!1;a.ticker.id=!1;a.storage("isConfigured")||a.firstTimeRun(a);$("head").append('<link rel="stylesheet" href="http://i242clan.com/plugin/c3.css" type="text/css" />');$("head").append('<link rel="stylesheet" href="http://i242clan.com/plugin/test/advanced_scoreboard.css" type="text/css" />');
$.ajax({url:"http://i242clan.com/plugin/d3.min.js",success:a.debug(a,0,"Loaded D3"),dataType:"script",cache:!0});$.ajax({url:"http://i242clan.com/plugin/c3.min.js",success:function(){a.debug(a,0,"Loaded C3");a.data.ticketsChart=c3.generate({bindto:"#as-server-chart",data:{columns:[],colors:{US:"#2f7191",RU:"#ff8e42",CN:"#ff8e42"}},point:{r:0},axis:{x:{show:!1},y:{tick:{values:function(){var b=[],e;for(e in a.data.tracker.tickets){var c=a.data.tracker.tickets[e];if(50>=c.length-1){var g=c[1];c=c[c.length-
1]}else g=b.push(c[c.length-50]),c=b.push(c[c.length-1]);b.push(g);100<Math.abs(g-c)&&b.push(c)}return b}}}}})},dataType:"script",cache:!0});$.ajax({url:"http://i242clan.com/plugin/sizeof.js",success:a.debug(a,0,"Loaded sizeof.js"),dataType:"script",cache:!0});window.items||$.ajax({type:"GET",dataType:"script",url:base.asset("/public/gamedatawarsaw/warsaw.items.js"),cache:!0});$("#server-players-list").hide();$("#serverbrowser-page").after('<div id="as-container"></div>');var b='<div id="as-server-header"><div id="as-server-title">'+
$(".server-title").text()+'<div class="as-server-indicator"><div id="as-live-indicator"></div>Live</div></div><div id="as-server-info"></div><div id="as-server-chart"></div></div>';$("#as-container").html(b);b=a.drawSelectors(a);$("#as-container").append(b);$("#as-container").append('<div id="as-scoreboard-container"></div>');b='<div id="as-debug-window" style="display:'+(a.storage("debuggingEnabled")?"block":"none")+'"><h6 class="as-header">Debug Information</h6><div id="as-debug-output"></div></div>';
$("#as-container").append(b);$("#as-container").append('<div class="as-overlay"></div>');a.updateAll(a);a.storage("liveEnabled")&&a.ticker.start(a);a.attachEventHandlers(a)},attachEventHandlers:function(a){$("#as-show-squads").click(function(){a.data.drawMode="squad";a.updateHTML(a);a.debug(a,0,"Draw Mode set to SQUADS")});$(".view-selector").click(function(){$(".view-selector").removeClass("btn-primary");$(this).addClass("btn-primary")});$("#as-container").on("click",".as-join-team",function(){for(var b=
$(this).attr("data-team-id"),d=a.data.latestScoreboardData.teams,e=0;e<d.length;e++){var c=d[e];if(c.status.teamId==b){a.joinTeam(c);break}}});$("#as-container").on("click",".as-player",function(){var b=$(this).attr("personaid");a.debug(a,0,"Player row has been clicked. PersonaId: "+b);var d=$(this);if(d.hasClass("as-advanced-stats-selected"))a.data.advancedViewPlayer=!1,a.data.scoreboard.animationActive=!0,$(".as-advanced-player-view").slideUp("fast",function(){$(".as-scoreboard-advanced-stats-row").remove();
d.removeClass("as-advanced-stats-selected");a.data.scoreboard.animationActive=!1});else{var e=$(".as-scoreboard-advanced-stats-row");if(0<e.length){var c=$(".as-advanced-stats-selected");$(".as-advanced-player-view").slideUp("fast",function(){e.remove();c.removeClass("as-advanced-stats-selected")})}a.data.advancedViewPlayer=b;b=a.createAdvancedPlayerView(a,b,!1);d.addClass("as-advanced-stats-selected").after(b);a.data.scoreboard.adimationActive=!0;$(".as-advanced-player-view").slideDown("fast",function(){a.data.scoreboard.animationActive=
!1})}});$("#as-container").on("click",".as-role-title-row",function(){var a=$(this).next("tr").find(".as-role-top-players");a.is(":visible")?a.slideUp("fast"):a.slideDown("fast")});$("#as-container").on("click","#as-ao-join",function(){var b=$(this).attr("persona-id");a.joinPlayer(b)});$("#as-container").on("click","#as-show-squads",function(){a.data.drawMode="squad";a.updateHTML(a)});$("#as-container").on("click","#as-show-players",function(){a.data.drawMode="player";a.updateHTML(a)});$("#as-container").on("click",
"#as-show-roles",function(){a.data.drawMode="role";a.updateHTML(a)});$("#as-container").on("click","#as-show-charts",function(){a.data.drawMode="charts";a.drawCharts(a)});$("#as-container").on("click","#as-settings",function(){a.data.drawMode="settings";a.drawSettings(a)});$("#as-container").on("click","#as-quit-game",function(){gamemanager._killGame(gamemanager.gameState.game)});$("#server-page").on("click",".as-stats-close",function(){$("#as-stats-container").animate({opacity:0,height:"toggle"},
1E3,function(){$("#as-stats-container").remove();a.data.mode="scoreboard";a.data.scoreboard.animationActive=!0;$("#as-container").animate({opacity:1,height:"toggle"},1E3,function(){a.data.scoreboard.animationActive=!1;a.updateHTML(a)});$("html, body").animate({scrollTop:$("#as-scoreboard-container").offset().top},1E3)})});$("#as-select-display-stat").on("change",function(){a.storage("displayStat",this.value);a.updateHTML(a)});$("#content").on("click","#as-settings-close",function(){$("#as-settings-container").remove()});
$("#as-container").on("click",".as-scoreboard-head td",function(){var b=$(this);b.hasClass("sort-desc")?(b.removeClass("sort-desc").addClass("sort-asc"),a.storage("sortMode","asc")):(b.hasClass("sort-asc")?b.removeClass("sort-asc").addClass("sort-desc"):b.addClass("sort-desc"),a.storage("sortMode","desc"));a.storage("sortAttribute",this.getAttribute("sort"));a.updateHTML(a)});$("#as-container").on("change","#as-enable-hilighting",function(){this.checked?a.storage("hilightingEnabled",!0):a.storage("hilightingEnabled",
!1);a.updateHTML(a)});$("#as-enable-friend-hilighting").change(function(){this.checked?a.storage("hilightingEnabled",!0):a.storage("hilightingEnabled",!1);a.updateHTML(a)});$("#content").on("change","#as-detailed-vehicles",function(){a.modifySetting(a,"detailedVehicles",this.checked)});$("#content").on("change","#as-vehicle-threshold",function(){var b=$(this).val();b&&a.storage("vehicleThreshold",b)});$("#content").on("change","#as-enable-live",function(){this.checked?($("#as-live-indicator").css({"background-color":"#78c753"}),
a.storage("liveEnabled",!0),a.ticker.isActive||(a.ticker.start(a),a.updateAll(a),a.debug(a,0,"Live Scoreboard Enabled"))):($("#as-live-indicator").css({"background-color":"red"}),a.storage("liveEnabled",!1),a.ticker.isActive&&(a.ticker.stop(a),a.debug(a,0,"Live Scoreboard Disabled")))});$("#content").on("change","#as-enable-debugging",function(){this.checked?(a.storage("debuggingEnabled",!0),$("#as-debug-window").fadeIn()):(a.storage("debuggingEnabled",!1),$("#as-debug-window").fadeOut())});$("#server-page").on("click",
".as-stats-select-weapons",function(){$(".as-stats-vehicles").slideUp("fast",function(){$(".as-stats-weapons").slideDown("fast")})});$("#server-page").on("click",".as-stats-select-vehicles",function(){$(".as-stats-weapons").slideUp("fast",function(){$(".as-stats-vehicles").slideDown("fast")})});$("#as-container").on("click",".join-team",function(){for(var b=$(this).attr("team-id"),d=a.data.latestScoreboardData.teams,e={},c=0;c<d.length;c++)if(d[c].status.teamId==b){e=d[c];break}b=140;d={};for(c=0;c<
e.players.length;c++){var g=e.players[c];g.rank<b&&(b=g.rank,d=g)}a.joinPlayer(d.personaId)});$("#as-render-scorboard-button").click(function(){a.updateAll(a)});$("#as-select-stat").change(function(){var b=$(this).val();a.storage("displayStat",b);a.updateHTML(a)})},firstTimeRun:function(a){a.storage("hilightingEnabled",!0);a.storage("liveEnabled",!0);a.storage("displayStat","kdRatio");a.storage("isConfigured",!0);a.storage("hilightFriends",!0);a.storage("liveTracking",!1);a.storage("sortAttribute",
"score");a.storage("sortMode","desc");a.storage("useResetKdr",!1);a.storage("debuggingEnabled",!1);a.storage("detailedVehicles",!1);a.storage("vehicleThreshold",500);alert("Configuration Parameters Successfully Set")},joinPlayer:function(a){var b=document.getElementById("server-page-join-buttons"),d=b.getAttribute("data-guid"),e=b.getAttribute("data-platform");b=b.getAttribute("data-game");window.gamemanager.joinServerByGuid(d,e,b,a,1)},modifySetting:function(a,b,d){a.storage(b,d)},joinTeam:function(a){for(var b=
{},d=0;d<a.players.length;d++){var e=a.players[d];e.hasOwnProperty("squad")&&(b.hasOwnProperty(e.squad)||(b[e.squad]=[]),b[e.squad].push(e))}a=[];for(var c in b){e=b[c];var g=e.length;if(5>g)for(d=0;d<g;d++)a.push(e[d])}a.sort(function(a,b){return a.rank<b.rank?-1:a.rank>b.rank?1:0});b=a[0].personaId;a=document.getElementById("server-page-join-buttons");d=a.getAttribute("data-guid");c=a.getAttribute("data-platform");a=a.getAttribute("data-game");window.gamemanager.joinServerByGuid(d,c,a,b,1)},scoreboard:{getTeamHeader:function(a,
b,d){var e=a.lookup.teamName(b.gameMode,d.status),c=a.lookup.teamFlag(e),g="";c&&(g='<img alt="flag" class="as-team-flag" src="'+c+'"></img>');c=Math.floor(d.status.tickets/d.status.ticketsMax*100);a=a.lookup.teamType(d.status.teamId);a='<div title="'+d.status.tickets+"/"+d.status.ticketsMax+'" class="progress-bar thicker no-border '+a+'" style="position: relative; display: inline-block; width: 100px; margin: 5px;"><div class="home progress-bar-inner" style="width:'+c+'%"></div></div>';c=d.globalStats.totalSkill/
d.playersLoaded;var k=d.globalStats.totalKd/d.playersLoaded,h=10*(d.globalStats.totalKillsPerMinute/d.playersLoaded*(d.globalStats.totalResetKd/d.playersLoaded)*10+d.globalStats.totalScorePerMinute/d.playersLoaded*c/1E4);return'<table class="as-team-summary"><tr><th>Team</th><th>Players</th><th>Tickets</th><th>K/D(G)</th><th>Skill</th><th>Strength</th><th>Join</th></tr><tr><td>'+g+e+"</td><td>"+d.players.length+"/"+(b.maxPlayers/2).toFixed(0)+"</td><td>"+a+"</td><td>"+k.toFixed(2)+"</td><td>"+c.toFixed(0)+
"</td><td>"+h.toFixed(0)+'</td><td><button data-team-id="'+d.status.teamId+'" class="as-join-team btn btn-primary">Join</button></td></tr></table>'},getPlayerRow:function(a,b){var d='<div class="bf4-rank rank small r'+b.rank+' rank_icon" data-rank="'+b.rank+'"></div>',e=0<b.tag.length?"["+b.tag+"]"+b.name:b.name;e='<a target="_blank" href="/bf4/user/'+b.name+'/">'+e+"</a>";var c=0==b.deaths?b.kills:b.kills/b.deaths,g=!1;a.storage("hilightingEnabled")&&b.statsLoaded&&(g=a.lookup.hilightingClass(a.storage("displayStat"),
b.pDisplayStat));var k=b.statsLoaded?b.pDisplayStat.toFixed(2):'<div class="loader small"></div>';return'<tr class="as-player'+(b.id==a.data.advancedViewPlayer?" as-advanced-stats-selected":"")+(g?" "+g:"")+'" personaid="'+b.id+'"><td>'+d+"</td><td>"+e+"</td><td>"+b.kills+"</td><td>"+b.deaths+"</td><td>"+b.score+"</td><td>"+c.toFixed(2)+"</td><td>"+k+"</td></tr>"},drawPlayers:function(a,b){a.debug(a,0,"Drawing PLAYER scoreboard");var d=a.calculateTeamTotals(a,b),e="";for(i=0;i<d.length;i++){var c=
d[i];e+='<div class="as-scoreboard-wrapper" teamId = "'+c.status.teamId+'"><table class="table as-scoreboard-table" teamId="'+c.status.teamId+'"><thead><tr class="as-scoreboard-details"><td colspan="7">';e+=this.getTeamHeader(a,b,c);e+='<tr class="as-scoreboard-head">';for(var g=[{header:"Rank",sortAttribute:"rank"},{header:"Name",sortAttribute:"name"},{header:"K",sortAttribute:"kills"},{header:"D",sortAttribute:"deaths"},{header:"Score",sortAttribute:"score"},{header:"K/D",sortAttribute:"kd"},{header:a.lookup.displayStat(a.storage("displayStat")),
sortAttribute:"pDisplayStat"}],k=a.storage("sortAttribute"),h=a.storage("sortMode"),f=0;f<g.length;f++){var l=g[f];e+="<td "+(l.sortAttribute==k?'class="sort-'+h+'"':"")+' sort="'+l.sortAttribute+'">'+l.header+(l.sortAttribute==k?'<div class="sort-'+h+'"></div>':"")+"</td>"}e+="</tr></thead>";c.players.sort(function(a,b){return"desc"==h?a[k]==b[k]?0:+(a[k]<b[k])||-1:a[k]==b[k]?0:+(a[k]>b[k])||-1});for(f=0;f<c.players.length;f++)g=c.players[f],e+=this.getPlayerRow(a,g),g.id==a.data.advancedViewPlayer&&
(e+=a.createAdvancedPlayerView(a,g.id,!0));f=Math.floor(c.totalRank/c.players.length);f='<div class="bf4-rank rank small r'+f+' rank_icon" data-rank="'+f+'"></div>';g=0==c.totalDeaths?c.totalKills:c.totalKills/c.totalDeaths;l=0==c.totalPDisplayStat?"...":(c.totalPDisplayStat/c.playersLoaded).toFixed(2);e+='<tfoot><tr class="as-scoreboard-foot"><td>'+f+"</td><td></td><td>"+c.totalKills+"</td><td>"+c.totalDeaths+"</td><td>"+c.totalScore+"</td><td>"+g.toFixed(2)+"</td><td>"+l+"</td></tr></tfoot>";e+=
"</table>";c.commander&&(c=c.commander,f='<div class="bf4-rank rank small r'+c.rank+' rank_icon" data-rank="'+c.rank+'"></div>',g=0==c.deaths?c.kills:c.kills/c.deaths,l=0<c.tag.length?"["+c.tag+"]"+c.name:c.name,pName='<a target="_blank" href="/bf4/user/'+c.name+'/">'+l+"</a>",e+='<table class="table as-commander-scoreboard"><tbody><tr><td>'+f+"</td><td>"+l+"</td><td>"+c.kills+"</td><td>"+c.deaths+"</td><td>"+c.score+"</td><td>"+g+"</td><td>"+c.pDisplayStat+"</td></tr></tbody></table>");e+="</div>"}this.drawRoundHeader(a,
b);$("#as-scoreboard-container").is(":visible")?$("#as-scoreboard-container").html(e):(a.unloadPlugin(a),a.handler(a))},drawSquads:function(a,b){a.debug(a,0,"Drawing SQUAD scoreboard");var d=a.calculateTeamTotals(a,b);html="";for(var e=0;e<d.length;e++){var c=d[e];html+='<div class="as-scoreboard-wrapper" teamId = "'+c.status.teamId+'"><table class="table as-scoreboard-table" teamId="'+c.status.teamId+'"><thead><tr class="as-scoreboard-details"><td colspan="7">';html+=this.getTeamHeader(a,b,c);var g=
[],k={};for(l=0;l<c.players.length;l++){var h=c.players[l];if(k.hasOwnProperty(h.squad)){var f=k[h.squad];f.totalRank+=h.rank;f.totalKills+=h.kills;f.totalDeaths+=h.deaths;f.totalScore+=h.score;f.players.push(h)}else k[h.squad]={totalRank:h.rank,totalKills:h.kills,totalDeaths:h.deaths,totalScore:h.score,totalCustomStat:0,players:[h],playersLoaded:0},g.push(h.squad);a.playerStats.hasOwnProperty(h.id)&&(f=a.playerStats[h.id].overviewStats[a.storage("displayStat")],k[h.squad].totalCustomStat+=f,k[h.squad].playersLoaded++)}g.sort();
for(var l=0;l<g.length;l++){h=g[l];f=k[h];var n=a.lookup.squadName(h);if(0!=h){html+='<tr class="as-squad-row"><td colspan="7">'+n.toUpperCase()+" ["+f.players.length+"/5]</td/></tr>";for(n=0;n<f.players.length;n++)h=f.players[n],html+=this.getPlayerRow(a,h),h.id==a.data.advancedViewPlayer&&(html+=a.createAdvancedPlayerView(a,h.id,!0));if(5>f.players.length)for(n=0;n<5-f.players.length;n++)html+='<tr class="as-blank"><td colspan="7"></td></tr>';h=Math.floor(f.totalRank/f.players.length);n=0<f.playersLoaded?
f.totalCustomStat/f.playersLoaded:0;html+='<tr class="as-squad-summary"><td>'+('<div class="bf4-rank rank small r'+h+' rank_icon" data-rank="'+h+'"></div>')+"<td></td><td>"+f.totalKills+"</td><td>"+f.totalDeaths+"</td><td>"+f.totalScore+"</td><td>"+(0<f.totalDeaths?f.totalKills/f.totalDeaths:f.totalKills).toFixed(2)+"</td><td>"+n.toFixed(2)+"</td></tr>";l<g.length-1&&(html+='<tr class="as-squad-spacer"><td colspan="7"></td></tr>')}}0==c.totalPDisplayStat||(c.totalPDisplayStat/c.playersLoaded).toFixed(2);
html+="</table>";html+="</div>"}this.drawRoundHeader(a,b);$("#as-scoreboard-container").is(":visible")?$("#as-scoreboard-container").html(html):(a.unloadPlugin(a),a.handler(a))},drawVehiclesss:function(a,b){a.debug(a,0,"Drawing VEHICLE scoreboard");a.calculateTeamTotals(a,b);a.storage("detailedVehicles")?($("#as-scoreboard-container").html('<div class="as-loading-data"><div class="loader small"></div><p>Loading Vehicle Statistics...</p></div>'),a.calculateDetailedRoles(a,b,function(a){for(var b={},
c=0;c<a.length;c++){var d=a[c],k;for(k in d){var h=d[k];b.hasOwnProperty(k)?h.totalKills>b[k].totalKills&&(b[k].totalKills=h.totalKills):b[k]={totalKills:h.totalKills}}}})):a.calculateRoles(a,b)},drawVehicles:function(a,b){function d(d,f){for(var h="",g=0;g<d.length;g++){var k=d[g],m=f[g];h+='<div class="as-scoreboard-wrapper" teamId = "'+k.status.teamId+'"><table class="table as-scoreboard-table" teamId="'+k.status.teamId+'"><thead><tr class="as-scoreboard-details"><td colspan="7">';h+=e.getTeamHeader(a,
b,k);h+="</td></tr></thead><tbody>";for(var r in m){k=m[r];for(var z='<div class="as-table-role vehicle xsmall '+a.battlelog.getVehicleImage(k.guid,0)+' image"></div>',w=0,x="",y=a.sortObject(k.players,"kills","desc"),t=0;t<y.length;t++){var u=k.players[y[t]];if(!(u.kills<a.storage("vehicleThreshold"))){w++;var p=u.roundStats,A='<div class="bf4-rank rank small r'+p.rank+' rank_icon" data-rank="'+p.rank+'"></div>',B=0<p.tag.length?"["+p.tag+"]"+p.name:p.name,C=0==p.deaths?p.kills:p.kills/p.deaths,
v="";a.storage("hilightingEnabled")&&(v=a.lookup.hilightingClass(a.storage("displayStat"),p.pDisplayStat));x+='<tr class="as-player'+(p.personaId==a.data.advancedViewPlayer?" as-advanced-stats-selected":"")+""+(v?" "+v:"")+'" personaid="'+p.personaId+'"><td>'+A+"</td><td>"+B+"</td><td>"+p.kills+"</td><td>"+p.deaths+"</td><td>"+p.score+"</td><td>"+C.toFixed(2)+"</td><td>"+u.kills+"</td></tr>"}}w&&(h+='<tr><th class="as-team-vehicle-header" colspan="7">'+r+z+"</th></tr>",h+=x)}h+="</tbody></table></div>"}a.scoreboard.drawRoundHeader(a,
c);$("#as-scoreboard-container").is(":visible")?$("#as-scoreboard-container").html(h):(a.unloadPlugin(a),a.handler(a))}var e=this;a.debug(a,0,"Drawing VEHICLE scoreboard");var c=b,g=a.calculateTeamTotals(a,b);if(a.storage("detailedVehicles"))$(".as-scoreboard-wrapper").is(":visible")||$("#as-scoreboard-container").html('<div class="as-loading-data"><div class="loader small"></div><p>Loading Vehicle Statistics...</p></div>'),a.calculateDetailedRoles(a,c,function(a){d(g,a)});else{var k=a.calculateRoles(a,
c);d(g,k)}},updateRoundHeader:function(a,b){var d='<img class="current-map" src="//eaassets-a.akamaihd.net/bl-cdn/cdnprefix/9c0b010cd947f38bf5e87df5e82af64e0ffdc12fh/public/base/bf4/map_images/195x79/'+b.mapName.toLowerCase()+'.jpg"></img><div id="as-map-name">'+a.data.gameServerWarsaw.mapLookup[b.mapName].label+'</div><div id="as-map-mode">'+a.lookup.gameMode(b.gameMode)+"</div>";$("#as-scoreboard-mapinfo").html(d);d=b.defaultRoundTimeMultiplier/100*3600-b.roundTime;d=Math.floor(d/60)+"M "+Math.round(d%
60*100)/100+"S";for(var e=0,c=0;c<b.teams.length;c++)e+=b.teams[c].players.length;d='<table class="as-round-properties"><tr><td>Players</td><td>'+e+"/"+b.maxPlayers+(0<b.queueingPlayers?"["+b.queueingPlayers+"]":"")+"</td></tr><tr><td>Time Remaining</td><td>"+d+"S</td></tr></table>";$("#as-scoreboard-round-properties").html(d)},drawRoundHeader:function(a,b){var d,e=0;for(d=0;d<b.teams.length;d++)e+=b.teams[d].players.length;d=""+('<div id="as-round-map"><img class="current-map" src="//eaassets-a.akamaihd.net/bl-cdn/cdnprefix/9c0b010cd947f38bf5e87df5e82af64e0ffdc12fh/public/base/bf4/map_images/195x79/'+
b.mapName.toLowerCase()+'.jpg"</img><div id="as-round-map-title">'+a.battlelog.getMapTitle(b.mapName)+'</div><div id="as-round-mode">'+a.battlelog.getGameMode(b.gameMode)+"</div></div>");d+='<div id="as-round-properties"><div><i class="players-icon"></i><span>Players</span><span>'+e+"/"+b.maxPlayers+(b.queueingPlayers?"["+b.queueingPlayers+"]":"")+"</span></div></div>";$("#as-server-info").html(d)}},drawCharts:function(a){$("#as-scoreboard-container").is(":visible")?$("#as-scoreboard-container").html('<div id="as-charting-container"></div>'):
(a.unloadPlugin(a),a.handler(a));var b=[];for(c in a.data.tracker.tickets)b.push(a.data.tracker.tickets[c]);b=[];var d={},e;for(e in a.data.latestScoreboardData.teams){var c=a.data.latestScoreboardData.teams[e];var g=a.lookup.teamName(a.data.latestScoreboardData.gameMode,c.status),k=[g+" skill"],h=[g+" kd"],f;for(f in c.players){var l=c.players[f].personaId;k.push(a.playerStats[l].overviewStats.skill);h.push(a.playerStats[l].overviewStats.kdRatio)}b.push(k,h);d[g+" skill"]=g+" kd"}a.data.charts.skillDistribution=
c3.generate({bindto:"#as-charting-container",data:{xs:d,columns:b,type:"scatter"},axis:{x:{label:"KD Ratio",min:0,tick:{fit:!1,centered:!0}},y:{label:"Skill",min:0}},tooltip:{format:{title:function(a){return"Data"+d[0]}}}})},updateAll:function(a){var b=a.getServerAttributes();a.queryServerScoreboard(b,function(b){32==b.gameMode&&(b.teams.pop(),b.teams.pop());$("#as-live-indicator").css({"background-color":"green"});setTimeout(function(){$("#as-live-indicator").css({"background-color":"#78c753"})},
250);a.data.latestScoreboardData=b;a.updatePlayerStats(a,b);a.updateTracker(a,b,function(a){a.updateCharts(a)});a.data.scoreboard.animationActive||"scoreboard"!=a.data.mode||("player"==a.data.drawMode?a.scoreboard.drawPlayers(a,b):"squad"==a.data.drawMode?a.scoreboard.drawSquads(a,b):"role"==a.data.drawMode?a.scoreboard.drawVehicles(a,b):"charts"==a.data.drawMode&&a.updateTracker(a,b,function(a){a.updateCharts(a)}))})},updateHTML:function(a){a.data.scoreboard.animationActive||"scoreboard"!=a.data.mode||
("player"==a.data.drawMode?a.scoreboard.drawPlayers(a,a.data.latestScoreboardData):"role"==a.data.drawMode?a.scoreboard.drawVehicles(a,a.data.latestScoreboardData):"squad"==a.data.drawMode&&a.scoreboard.drawSquads(a,a.data.latestScoreboardData))},updateTracker:function(a,b,d){for(i=0;i<b.teams.length;i++){var e=b.teams[i],c=e.status.teamId,g=e.status.tickets;a.data.tracker.tickets.hasOwnProperty(c)?a.data.tracker.tickets[c].push(g):a.data.tracker.tickets[c]=[a.lookup.teamName(b.gameMode,e.status),
g]}d(a)},updateCharts:function(a){if(a.data.ticketsChart){var b=[],d;for(d in a.data.tracker.tickets){var e=a.data.tracker.tickets[d],c=e[0];50>=e.length-1?b.push(e):b.push([c].concat(e.slice(-50)))}a.data.ticketsChart.load({columns:b})}},calculateTeamTotals:function(a,b){for(var d=[],e=0;e<b.teams.length;e++){for(var c=b.teams[e],g={players:[],status:c.status,totalPlayers:0,totalRank:0,totalKills:0,totalDeaths:0,totalScore:0,playersLoaded:0,totalPDisplayStat:0,globalStats:{totalKd:0,totalResetKd:0,
totalKills:0,totalDeaths:0,totalSkill:0,totalScorePerMinute:0,totalKillsPerMinute:0},commander:!1},k=0;k<c.players.length;k++){var h=c.players[k],f={id:h.personaId,tag:h.tag,name:h.name,rank:h.rank,role:h.role,squad:h.squad,score:h.score,kills:h.kills,deaths:h.deaths,kd:0==h.deaths?h.kills:h.kills/h.deaths,globalStats:{kd:0,resetKd:0,kills:0,deaths:0,skill:0,scorePerMinute:0,killsPerMinute:0},statsLoaded:!1,pDisplayStat:0};if(2==h.role)g.commander=f;else{g.totalRank+=h.rank;g.totalKills+=h.kills;
g.totalDeaths+=h.deaths;g.totalScore+=h.score;g.totalPlayers++;if(a.playerStats.hasOwnProperty(h.personaId)){f.statsLoaded=!0;h=a.playerStats[h.personaId];f.globalStats.kills=h.overviewStats.kills;f.globalStats.deaths=h.overviewStats.deaths;f.globalStats.kd=0==h.overviewStats.deaths?h.overviewStats.kills:h.overviewStats.kills/h.overviewStats.deaths;f.globalStats.resetKd=h.overviewStats.kdRatio;f.globalStats.skill=h.overviewStats.skill;f.globalStats.scorePerMinute=h.overviewStats.scorePerMinute;f.globalStats.killsPerMinute=
h.overviewStats.killsPerMinute;var l=a.storage("displayStat");switch(a.storage("displayStat")){case "kdRatio":a.storage("useResetKdr")?f.pDisplayStat=h.overviewStats.kdRatio:f.pDisplayStat=0==h.overviewStats.deaths?h.overviewStats.kills:h.overviewStats.kills/h.overviewStats.deaths;break;case "strength":f.pDisplayStat=Math.floor(10*(h.overviewStats.killsPerMinute*h.overviewStats.kdRatio*10+h.overviewStats.skill*h.overviewStats.scorePerMinute/1E4));break;default:f.pDisplayStat=h.overviewStats[l]}g.totalPDisplayStat+=
f.pDisplayStat;g.globalStats.totalKills+=f.globalStats.kills;g.globalStats.totalDeaths+=f.globalStats.deaths;g.globalStats.totalKd+=f.globalStats.kd;g.globalStats.totalResetKd+=f.globalStats.resetKd;g.globalStats.totalSkill+=f.globalStats.skill;g.globalStats.totalScorePerMinute+=f.globalStats.scorePerMinute;g.globalStats.totalKillsPerMinute+=f.globalStats.killsPerMinute;g.playersLoaded++}g.players.push(f)}}d.push(g)}return d},calculateDetailedRoles:function(a,b,d){a.updatePlayerVehicleStats(a,b,function(e){e=
[];for(var c in b.teams){var g=b.teams[c],k={},h;for(h in g.players){var f=g.players[h];if(a.playerVehicleStats.hasOwnProperty(f.personaId)){var l=a.playerStats[f.personaId],n=a.playerVehicleStats[f.personaId].mainVehicleStats,q;for(q in n){var m=n[q];0!=m.kills&&(k.hasOwnProperty(m.category)||(k[m.category]={players:{},totalKills:0,totalTime:0,guid:m.guid}),k[m.category].players.hasOwnProperty(f.personaId)?(k[m.category].players[f.personaId].vehiclesDestroyed+=m.destroyXinY,k[m.category].players[f.personaId].kills+=
m.kills,k[m.category].players[f.personaId].time+=m.timeIn):k[m.category].players[f.personaId]={personaId:f.personaId,name:l.name,vehiclesDestroyed:m.destroyXinY,roundStats:f,kills:m.kills,time:m.timeIn,stars:m.serviceStars},k[m.category].totalKills+=m.kills,k[m.category].totalTime+=m.timeIn)}}}for(var r in k)100>k[r].totalKills&&delete k[r];e.push(k)}d(e)})},calculateRoles:function(a,b){var d=[];for(teamId in b.teams){var e=b.teams[teamId],c={};for(playerId in e.players){var g=e.players[playerId];
if(a.playerStats.hasOwnProperty(g.personaId))for(var k=a.playerStats[g.personaId].topVehicles,h=0;h<k.length;h++){var f=k[h];if(!(100>f.kills))if(c.hasOwnProperty(f.category)||(c[f.category]={players:{},totalKills:0,totalTime:0,guid:f.guid}),c[f.category].players.hasOwnProperty(g.personaId)){var l=c[f.category].players[g.personaId];l.kills+=f.kills;l.timeIn+=f.timeIn;l.vehiclesDestroyed+=f.destroyXinY}else c[f.category].players[g.personaId]={roundStats:g,kills:f.kills,timeIn:f.timeIn,vehiclesDestroyed:f.destroyXinY}}}d.push(c)}return d},
updateRoundHeader:function(a,b){for(var d=0,e=0;e<b.teams.length;e++)d+=b.teams[e].players.length;$("#as-server-players").html(d+"/"+b.maxPlayers+(0<b.queueingPlayers?"["+b.queueingPlayers+"]":""))},createAdvancedPlayerView:function(a,b,d){var e;if(!a.playerStats.hasOwnProperty(b))return e='<div class="loader small"></div></div></td></tr>';var c=a.playerStats[b],g=c.name;if(c.activeEmblem){var k=c.activeEmblem.cdnUrl;k=k.replace("[SIZE]","128");k=k.replace("[FORMAT]","png")}e='<tr class="as-scoreboard-advanced-stats-row"><td colspan="7"><div class="as-advanced-player-view"'+
(d?"":' style="display:none"')+">";e+='<div class="as-ao-header"><span id="as-ao-name">'+g+(c.activeEmblem?'</span><img class="as-ao-emblem" src="'+k+'"></img>':"")+'<button id="as-ao-join" persona-id="'+b+'" class="as-ao-btn btn btn-primary">Join Player</button><button id="as-ao-radar" persona-id="'+b+'" class="as-ao-btn btn btn-primary">Add to Radar</button></div>';b=c.overviewStats.timePlayed/60/60;b=Math.floor(b)+"H "+Math.round(60*(b-Math.floor(b)))+"M";e+='<table class="as-stats-overview"><tr><th>Kills</th><th>Deaths</th><th>Skill</th><th>Accuracy</th></tr><tr><td>'+
a.commaFormat(c.overviewStats.kills)+"</td><td>"+a.commaFormat(c.overviewStats.deaths)+"</td><td>"+c.overviewStats.skill+"</td><td>"+c.overviewStats.accuracy.toFixed(2)+"% </td></tr><tr><th>K/D</th><th>KPM</th><th>SPM</th><th>Time</th></tr><tr><td>"+(c.overviewStats.kills/c.overviewStats.deaths).toFixed(2)+"</td><td>"+c.overviewStats.killsPerMinute+"</td><td>"+c.overviewStats.scorePerMinute+"</td><td>"+b+"</td></tr></table>";e+='<table class="as-role-stats as-vehicle-stats"><tr><th>Vehicle</th><th>Kills</th><th>KPM</th></tr>';
for(var h in c.topVehicles)b=c.topVehicles[h],d=b.slug,k=0<b.timeIn?(b.kills/(b.timeIn/60)).toFixed(2):"--",g=a.battlelog.getVehicleImage(b.guid,0),e+="<tr><td>"+d.toUpperCase()+'<div class="as-table-role vehicle xsmall '+g+' image"></div></td><td>'+a.commaFormat(b.kills)+"</td><td>"+k+"</tr>";e+="</table>";e+='<table class="as-role-stats as-weapon-stats"><tr><th>Weapon</th><th>Kills</th><th>Accuracy</th></tr>';for(var f in c.topWeapons)h=c.topWeapons[f],b=h.slug,d=a.battlelog.getWeaponImage(h.guid,
0),e+="<tr><td>"+b.toUpperCase()+'<div class="as-table-role weapon xsmall '+d+' image"></div></td><td>'+a.commaFormat(h.kills)+"</td><td>"+(h.shotsHit/h.shotsFired*100).toFixed(2)+"%</tr>";e+="</table>";e+="</div></td></tr>";e+='<table class="table as-advanced-overview-top-kits"><tr><th><div class="kit-icon xsmall kit-1"></div></th><th><div class="kit-icon xsmall kit-2"></div></th><th><div class="kit-icon xsmall kit-32"></div></th><th><div class="kit-icon xsmall kit-8"></div></th></tr><tr><td>'+c.overviewStats.serviceStars["1"]+
"</td><td>"+c.overviewStats.serviceStars["2"]+"</td><td>"+c.overviewStats.serviceStars["32"]+"</td><td>"+c.overviewStats.serviceStars["8"]+"</td></table>";e+="</div>";e+='<div class="as-advanced-overview-top-roles"><table class="table as-advanced-overview-top-vehicles"><tr><th colspan="2">Vehicle</th><th>Kills</th><th>KPM</th></tr>';$.each(c.topVehicles,function(b,c){var d=window.items.game_data.compact.vehicles[c.guid];d=d.see[0];d=window.items.game_data.compact.vehicles[d];d=d.imageConfig.slug;
e+="<tr><td>"+c.slug.toUpperCase()+'</td><td><div class="vehicle xsmall '+d+' image"></div></td><td>'+a.commaFormat(c.kills)+"</td><td>"+(c.kills/(c.timeIn/60)).toFixed(2)+"</td></tr>"});e+='</table><table class="table as-advanced-overview-top-weapons"><tr><th colspan="2">Weapon</th><th>Kills</th><th>Accuracy</th></tr>';$.each(c.topWeapons,function(b,c){var d=window.items.game_data.compact.weapons[c.guid];d=d.see[0];d=window.items.game_data.compact.weapons[d];d=d.imageConfig.slug;e+="<tr><td>"+c.slug.toUpperCase()+
'</td><td><div class="weapon xsmall '+d+' image"></div></td><td>'+a.commaFormat(c.kills)+"</td><td>"+(c.shotsHit/c.shotsFired*100).toFixed(2)+"%</td></tr>"});e+="</table></div>";e+="</div>";return e+="</div>"},drawAdvancedStats:function(a,b){var d=a.playerStats[b],e={};a.loadPlayerVehicleStats(b,function(a){e=a.data});var c={};a.loadPlayerWeaponStats(b,function(a){c=a.data;$("#as-container").fadeOut("slow",function(){var a='<div id="as-stats-container"><button class="as-stats-close">Back</button>'+
("<h3>"+d.name+"</h3>");a+='<div class="as-stats-selectors"><button class="btn as-stats-select-weapons">Weapons</button><button class="btn as-stats-select-vehicles">Vehicles</button></div><div class="as-stats-overview"><div class="as-stats-weapons"><table class="table as-stats-weapons-table"><tr><th>Weapon</th><th>Kills</th><th>Accuracy</th><th>HSKR</th><th>KPM</th></tr>';for(var b=0;b<c.mainWeaponStats.length;b++)if(100<weapon.kills){var f=window.items.game_data.compact.weapons[weapon.guid];f=f.see[0];
f=window.items.game_data.compact.weapons[f];f=f.imageConfig.slug;var g=0;0<weapon.shotsFired&&0<weapon.shotsHit&&(g=weapon.shotsHit/weapon.shotsFired*100);var n=0;0<weapon.kills&&0<weapon.timeEquipped&&(n=weapon.kills/(weapon.timeEquipped/60));var q=0;0<weapon.kills&&0<weapon.headshots&&(q=weapon.headshots/weapon.kills*100);a+='<tr class="as-stats-weapon"><td><div class="weapon xsmall '+f+' image"></div><div>'+weapon.slug.toUpperCase()+"</div></td><td>"+weapon.kills+"</td><td>"+g.toFixed(2)+"%</td><td>"+
q.toFixed(2)+"%</td><td>"+n.toFixed(2)+"</td></tr>"}a+='</table></div><div class="as-stats-vehicles" style="display: none;"><table class="table as-stats-vehicles-table"><tr><th>Vehicle</th><th>Kills</th><th>Vehicles Destroyed</th><th>KPM</th><th>Time</th></tr>';for(b=0;b<e.mainVehicleStats.length;b++)if(g=e.mainVehicleStats[b],100<g.kills){f=window.items.game_data.compact.vehicles[g.guid];f=f.see[0];f=window.items.game_data.compact.vehicles[f];f=f.imageConfig.slug;n=0;0<g.destroyXinY&&(n=g.destroyXinY);
q=0;0<g.timeIn&&0<g.kills&&(q=g.kills/(g.timeIn/60));var m=(g.timeIn/60).toFixed(2);a+='<tr class="as-stats-vehicle"><td><div class="vehicle xsmall '+f+' image"></div><div>'+g.slug.toUpperCase()+"</div></td><td>"+g.kills+"</td><td>"+n+"</td><td>"+q.toFixed(2)+"%</td><td>"+m+"</td></tr>"}a+="</table></div></div>";$("#serverbrowser-page").after(a)})})},getRuntimeOptions:function(a){a={kdRatio:"KD (G)",strength:"Strength",skill:"Skill"};var b='<select id="as-select-stat">',d;for(d in a)b+='<option value="'+
d+'">'+a[d]+"</option>";return b+"</select>"},drawSettings:function(a){var b='<div id="as-settings-container"><header class="as-settings-header"><h1>'+a.t("settings-title")+'</h1></header><div id="as-settings-options">',d=a.storage("hilightingEnabled")?1==a.storage("hilightingEnabled")?!0:!1:!1;b+='<table class="as-settings-table"><tr><td class="as-settings-table-header" colspan="3">General</td></tr><tr><th>Live Scoreboard</th><td><div class="switch-container pull-right clearfix"><div class="switch pull-left"><input type="checkbox" id="as-enable-live" name="as-enable-live" value="'+
a.storage("liveEnabled").toString()+'" '+(1==a.storage("liveEnabled")?"checked":"")+'><div class="handle"></div></div></div></td><td class="option-description">Determines whether or not the scoreboard automatically updates as the game progresses</td></tr><tr><th>Hilighting</th><td><div class="switch-container pull-right clearfix"><div class="switch pull-left"><input type="checkbox" id="as-enable-hilighting" name="as-enable-hilighting" value="'+d.toString()+'" '+(1==d?"checked":"")+'><div class="handle"></div></div></div></td><td class="option-description">Enables hilighting based off the strength of player statistics</td></tr><tr><th>Polling Rate (ms)</th><td><input id="as-polling-rate" type="number" name="as-polling-rate" value="5000"></td><td class="option-description">The frequency the scoreboard queries the gameserver for information. 5000ms is the default</td></tr><tr><th>Debug Information</h><td><div class="switch-container pull-right clearfix"><div class="switch pull-left"><input type="checkbox" id="as-enable-debugging" name="as-enable-debugging" value="'+
a.storage("debuggingEnabled").toString()+'" '+(1==a.storage("debuggingEnabled")?"checked":"")+'><div class="handle"></div></div></div></td><td class="option-description">Enable debugging window</td></tr><tr><td class="as-settings-table-header" colspan="3">Statistics</td></tr><tr><th>Detailed Vehicle Overview</th><td><div class="switch-container pull-right clearfix"><div class="switch pull-left"><input type="checkbox" id="as-detailed-vehicles" name="as-detailed-vehicles" value="'+a.storage("detailedVehicles").toString()+
'" '+(1==a.storage("detailedVehicles")?"checked":"")+'><div class="handle"></div></div></div></td><td class="option-description">Gives a more complete view of vehicle stats. <br> Warning: Enabling this option will increase the number of requests sent to Battlelog</td></tr><tr><th>Vehicle Kill Threshold</th><td><input type="number" name="as-vehicle-threshold" id="as-vehicle-threshold" value="'+a.storage("vehicleThreshold").toString()+'" /></td><td class="option-description">The number of kills a player must have in a given vehicle to appear in the vehicle overview.</td></tr>';
b+="</table>";$("#as-scoreboard-container").html(b)},renderSettings:function(a){var b='<div id="advs_scoreboard_settings">'+('<h4 class="advs_title">'+a.t("settings-title")+"</h4>");b=b+'<div class="as-settings-option"><label class="as-settings-label" for="as-enable-live">Live Scoreboard</label>'+('<input id="as-enable-live" type="checkbox" name="as-enable-live" value="'+a.storage("liveEnabled").toString()+'" '+(1==a.storage("liveEnabled")?"checked":"")+">");b=b+'</div><div class="as-settings-option"><label class="as-settings-label" for="as-enable-hilighting">Enable Hilighting</label>'+
('<input id="as-enable-hilighting" type="checkbox" name="as-enable-hilighting" value="'+a.storage("hilightingEnabled").toString()+'" '+(1==a.storage("hilightingEnabled")?"checked":"")+">");b=b+'</div><div class="as-settings-option"><label class="as-settings-label" for="as-enable-friend-hilighting">Hilight Friends</label>'+('<input id="as-enable-friend-hilighting" type="checkbox" name="as-enable-friend-hilighting" value="'+a.storage("hilightFriends").toString()+'" '+(1==a.storage("hilightFriends")?
"checked":"")+">");b+='</div><div class="as-about" style="font-size: 10px;"><p>Advanced Scoreboard 0.1.1 Beta</p><p>Developed by Cr1N</p></div></div>';$("#content").append(b)},drawRoundInfo:function(a){var b='<div id="as-scoreboard-roundinfo"><div id="as-scoreboard-mapinfo"></div><div id="as-scoreboard-round-properties"><div><span>Players : </span><span id="as-server-players"></span></div><div><span>Time : </span><span id="as-server-time-remaining"></span></div></div><div id="as-scoreboard-options"><div class="as-sort-option"><label class="as-settings-label" for="as-select-display-stat">Show: </label><select id="as-select-display-stat">';
for(var d=a.storage("displayStat"),e=["skill","kdRatio","kills","deaths","strength"],c=0;c<e.length;c++)b=e[c]!==d?b+('<option value="'+e[c]+'">'+a.lookup.displayStat(e[c])+"</option>"):b+('<option value="'+e[c]+'" selected>'+a.lookup.displayStat(e[c])+"</option>");return b+"</select></div></div>"},drawSelectors:function(a){var b=[{htmlId:"as-show-players",htmlText:"Show Players",drawMode:"player"},{htmlId:"as-show-squads",htmlText:"Show Squads",drawMode:"squad"},{htmlId:"as-show-roles",htmlText:"Show Vehicles",
drawMode:"role"},{htmlId:"as-show-charts",htmlText:"Show Charts",drawMode:"charts"}];selectorHtml='<div id="as-scoreboard-selectors">';for(var d=0;d<b.length;d++){var e=b[d];selectorHtml+='<button class="btn view-selector '+(a.data.drawMode===e.drawMode?"btn-primary":"")+'" id="'+e.htmlId+'">'+e.htmlText+"</button>"}selectorHtml+='<button class="btn view-selector" id="as-settings">Settings</button>';return selectorHtml+="</div>"},debug:function(a,b,d){if(a.storage("debuggingEnabled")){a=$("#as-debug-output");
var e=new Date;e=("0"+e.getHours()).slice(-2)+":"+("0"+e.getMinutes()).slice(-2)+":"+("0"+e.getSeconds()).slice(-2);switch(b){case 0:a.append('<p class="as-debug-information"><span class="as-debug-time">['+e+"]</span><span>"+d+"</span></p>");break;case 1:a.append('<p class="as-debug-success"><span class="as-debug-time">['+e+"]</span><span>"+d+"</span></p>");break;case 2:a.append('<p class="as-debug-error"><span class="as-debug-time">['+e+"]</span><span>"+d+"</span></p>");break;default:a.append('<p class="as-debug-information"><span class="as-debug-time">['+
e+"]</span><span>"+d+"</span></p>")}}},getServerAttributes:function(){var a=$("#server-page-join-buttons");return{ip:a.data("ip"),gameId:a.attr("data-gameid"),port:a.data("port"),game:a.data("game"),guid:a.data("guid")}},queryServerScoreboard:function(a,b){launcher.queryServer(a,function(a){a?"OK"==a.status?b(a.result):$("#as-scoreboard-container").html('<div class="as-scoreboard-roundfinished">Round is over. Waiting for next round to start...</div>'):instance.debug(instance,2,"Could not obtain information from the server")})},
updatePlayerVehicleStats:function(a,b,d){var e=[];for(teamId in b.teams){var c=b.teams[teamId];for(playerId in c.players){var g=c.players[playerId];a.playerVehicleStats.hasOwnProperty(g.personaId)||e.push(g.personaId)}}if(0==e.length)d(a.playerVehicleStats);else{var k=0;for(b=0;b<e.length;b++)a.loadPlayerVehicleStats(e[b],function(b){b=b.data;a.playerVehicleStats[b.personaId]=b;k+=1;k==e.length&&d(a.playerVehicleStats)})}},updatePlayerStats:function(a,b){var d=0,e=0;$.each(b.teams,function(b,e){$.each(e.players,
function(b,c){a.playerStats.hasOwnProperty(c.personaId)||d++})});$.each(b.teams,function(b,g){$.each(g.players,function(b,c){a.playerStats.hasOwnProperty(c.personaId)||a.loadPlayerStats(c.personaId,c.tag?"["+c.tag+"]"+c.name:c.name,function(b,g){"profile.warsawoverviewpopulate"==b.data.statsTemplate?(a.playerStats[c.personaId]=b.data,a.playerStats[c.personaId].name=g,e++,e==d&&a.updateHTML(a)):d--})})})},loadPlayerStats:function(a,b,d){$.ajax({url:"http://battlelog.battlefield.com/bf4/warsawoverviewpopulate/"+
a+"/1/",type:"GET",async:!0,cache:!1,timeout:3E4,success:function(a){d(a,b)}})},loadPlayerWeaponStats:function(a,b){$.ajax({url:"http://battlelog.battlefield.com/bf4/warsawWeaponsPopulateStats/"+a+"/1/stats/",type:"GET",async:!0,cache:!1,timeout:3E4,success:function(a){b(a)}})},loadPlayerVehicleStats:function(a,b){$.ajax({url:"http://battlelog.battlefield.com/bf4/warsawvehiclesPopulateStats/"+a+"/1/stats/",type:"GET",async:!0,cache:!1,timeout:3E4,success:function(a){b(a)}})},lookup:{displayStat:function(a){return{skill:"Skill",
kdRatio:"K/D (G)",kills:"Kills",deaths:"Deaths",strength:"Strength"}[a]},teamName:function(a,b){return 2==a?"attackers"==b.teamType?"ATK":"DEF":["US","RU","CN"][b.faction]},teamType:function(a){return 1==a?"home":"away"},teamFlag:function(a){return"US"==a||"RU"==a||"CN"==a?"http://eaassets-a.akamaihd.net/bl-cdn/cdnprefix/2e8fa20e7dba3f4aecb727fc8dcb902f1efef569b/public/common/flags/"+a.toLowerCase()+".gif":!1},squadName:function(a){return"No Squad;Alpha;Bravo;Charlie;Delta;Echo;Foxtrot;Golf;Hotel;India;Juliett;Kilo;Lima;Mike;Oscar;Lima".split(";")[a]},
gameMode:function(a){var b={2:"Rush",64:"Conquest Large"};return b.hasOwnProperty(a)?b[a]:"Unknown Gamemode"},hilightingClass:function(a,b){"kdRatio"==a?1>b?hilightingType="low":2>b?hilightingType="average":3>b?hilightingType="good":4>b?hilightingType="high":5>b?hilightingType="v-high":5<=b&&(hilightingType="pro"):"skill"==a?200>b?hilightingType="low":300>b?hilightingType="average":400>b?hilightingType="good":550>b?hilightingType="high":550<=b&&(hilightingType="v-high"):"strength"==a&&(200>b?hilightingType=
"low":300>b?hilightingType="average":400>b?hilightingType="good":550>b?hilightingType="high":550<=b&&(hilightingType="v-high"));return hilightingType}},sortObject:function(a,b,d){var e=[],c;for(c in a)e.push(c);e.sort(function(c,e){return a[c][b]<a[e][b]?"desc"==d?1:-1:a[c][b]>a[e][b]?"desc"==d?-1:1:0});return e},commaFormat:function(a){return a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},unloadPlugin:function(a){a.ticker.isActive&&a.ticker.stop(a);a.data.advancedViewPlayer=0;a.data.pluginLoaded=
!1;a.data.currentChart=!1;for(var b in a.data.tracker)a.data.tracker[b]={}}});